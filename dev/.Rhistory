mutate(
prop=n/sum(n)
)
ggplot(anes_vote_education,
aes(x=income, y=prop, fill=vote)) +
geom_bar(stat="identity", colour="white") + facet_wrap(~education, ncol=1) +theme_bw()+
scale_fill_brewer(palette="BuPu")+
labs(title="How did different racial groups participated in the election \n over the years?")
anes_vote_education = anes_white %>%
group_by(income,education)%>%
count(vote)%>%
group_by(income,education)%>%
mutate(
prop=n/sum(n)
)
ggplot(anes_vote_education,
aes(x=income, y=prop, fill=vote)) +
geom_bar(stat="identity", colour="white") + facet_wrap(~education, ncol=1) +theme_bw()+
scale_fill_brewer(palette="BuPu")+
labs(title="How did different racial groups participated in the election \n over the years?")
anes_vote_education = anes_white %>%
group_by(income,education)%>%
count(vote)%>%
group_by(income,education)%>%
mutate(
prop=n/sum(n)
)
ggplot(anes_vote_education,
aes(x=income, y=prop, fill=vote)) +
geom_bar(stat="identity", colour="white") + facet_wrap(~education, ncol=1) +theme_bw()+
scale_fill_brewer(palette="BuPu")+
labs(title="How did different racial groups participated in the election \n over the years?")
anes_vote_education = anes_white %>%
group_by(self.consider,education)%>%
count(vote)%>%
group_by(self.consider,education)%>%
mutate(
prop=n/sum(n)
)
ggplot(anes_vote_education,
aes(x=self.consider, y=n, fill=vote)) +
geom_bar(stat="identity", colour="white") + facet_wrap(~education, ncol=1) +theme_bw()+
scale_fill_brewer(palette="BuPu")+
labs(title="How did different racial groups participated in the election \n over the years?")
anes_vote_education = anes_white %>%
group_by(self.consider,education)%>%
count(vote)%>%
group_by(self.consider,education)%>%
mutate(
prop=n/sum(n)
)
ggplot(anes_vote_education,
aes(x=self.consider, y=n, fill=vote)) +
geom_bar(stat="identity", colour="white") + facet_wrap(~education, ncol=1) +theme_bw()+
scale_fill_brewer(palette="BuPu")+
labs(title="How did different racial groups participated in the election \n over the years?")
anes_vote_education = anes_white %>%
group_by(self.consider,education)%>%
count(vote)%>%
group_by(self.consider,education)%>%
mutate(
prop=n/sum(n)
)
ggplot(anes_vote_education,
aes(x=self.consider, y=n, fill=vote)) +
geom_bar(stat="identity", colour="white") + facet_wrap(~education, ncol=1) +theme_bw()+
scale_fill_brewer(palette="BuPu")+
labs(title="How did different racial groups participated in the election \n over the years?")
anes_vote_education = anes_white %>%
group_by(self.consider,education)%>%
count(vote)%>%
group_by(self.consider,education)%>%
mutate(
prop=n/sum(n)
)
ggplot(anes_vote_education,
aes(x=self.consider, y=n, fill=vote)) +
geom_bar(stat="identity", colour="white") + facet_wrap(~education, ncol=1) +theme_bw()+
scale_fill_brewer(palette="BuPu")+
labs(title="How did different racial groups participated in the election \n over the years?")
anes_white <- na.omit(anes_white %>% select(-care.win))
packages.used=as.list(
c(
"tidyverse",
"haven",
"devtools",
"RColorBrewer",
"data.table",
"ggplot2",
"readr",
"corrplot")
)
check.pkg = function(x){
if(!require(x, character.only=T)) install.packages(x,
character.only=T,
dependence=T)
}
lapply(packages.used, check.pkg)
anes_dat <- read_sav("../data/anes_timeseries_cdf.sav")
Election_years=as.character(seq(1952, 2016, 4))
anes_use=anes_dat%>%
mutate(
year=as_factor(VCF0004),
#vote
turnout = as_factor(VCF0703),
vote = as_factor(VCF0706),
#natural
race = as_factor(VCF0105a),
gender = as_factor(VCF0104),
#environment
education = as_factor(VCF0110),
region = as_factor(VCF0112),
income = as_factor(VCF0114),
#political issue
self.consider = as_factor(VCF0301),
interest = as_factor(VCF0310),
care.win = as_factor(VCF0311),
)%>%
filter(year %in% Election_years)
data.table(anes_use%>%
select(year, turnout, vote, race, gender, education,
region, income, self.consider, interest, care.win)%>%
filter(!is.na(turnout))%>%
sample_n(30))
anes_use = anes_use%>%select(year, turnout, vote, race, gender, education,
region, income, self.consider, interest, care.win)
anes_use <- anes_use %>% filter(!is.na(race)) %>% filter(!is.na(turnout)) %>% filter(!is.na(vote)) %>% filter(!is.na(education))
save(anes_use, file="../output/data_use.RData")
write_csv(anes_use,"../output/data_use.csv")
a <- anes_use$race
df_race <- data.frame(table(a))
x_names <- c("White","Black","Asian","American Indian","Hispanic","Other1968","Other1964","Missing")
df_race$a <- x_names
ggplot(df_race,aes(x=a,y=Freq))+
geom_bar(stat="identity",fill = "orange")+coord_polar(theta = "y")+
labs(
x = "",
y = "",
title = "Number of Respondents of Different Race"
)
anes_white <- anes_use %>% filter(race == "1. White non-Hispanic (1948-2012)" ) %>% select(-race,-gender,-region)
anes_vote_to_education_year = anes_white %>%
group_by(year, education)%>%
count(vote)%>%
group_by(year, education)%>%
mutate(
prop=n/sum(n)
)
ggplot(anes_vote_to_education_year,
aes(x=year, y=prop, fill=vote)) +
geom_bar(stat="identity", colour="black") + facet_wrap(~education, ncol=1) + theme_bw()+
theme(axis.text.x = element_text(angle = 90))+
scale_fill_brewer(palette="Blues")+
labs(title="How did Different Education Groups Acted in the Election?")
anes_white <- anes_white %>% filter(vote !="3. Major third party candidate (Wallace 1968/Anderson")
anes_education_to_vote_year = anes_white %>%
group_by(year, vote)%>%
count(education)%>%
group_by(year, vote)%>%
mutate(
prop=n/sum(n)
)
ggplot(anes_education_to_vote_year,
aes(x=year, y=prop, fill=education)) +
geom_bar(stat="identity", colour="black") + facet_wrap(~vote, ncol=1) + theme_bw()+
theme(axis.text.x = element_text(angle = 90))+
scale_fill_brewer(palette="Blues")+
labs(title="Education Level of People supporting the Candidates?")
anes_education_to_year = anes_white %>%
group_by(year)%>%
count(education)%>%
group_by(year)%>%
mutate(
prop=n/sum(n)
)
ggplot(anes_education_to_year,
aes(x=year, y=prop, fill=education)) +
geom_bar(stat="identity", colour="white") + theme_bw()+
theme(axis.text.x = element_text(angle = 90))+
scale_fill_brewer(palette="BuPu")+
labs(title="The Proportion of People with Different Education Level over years")
anes_vote_education = anes_white %>%
group_by(year,education)%>%
count(turnout)%>%
group_by(year,education)%>%
mutate(
prop=n/sum(n)
)
ggplot(anes_vote_education,
aes(x=year, y=prop, fill=turnout)) +
geom_bar(stat="identity", colour="white") + facet_wrap(~education, ncol=1) +theme_bw()+
theme(axis.text.x = element_text(angle = 90))+
scale_fill_brewer(palette="BuPu")+
labs(title="Did They Really Vote?")
anes_cor <- (anes_white %>% select(education,income,interest,care.win)
%>% filter(education !="0. DK; NA; no Pre IW; short-form 'new' Cross Section" )
%>% filter(income !="0. DK; NA; refused to answer; no Pre IW")
%>% filter(interest !="0. NA; no Pre IW; version B (2008)" & interest !="9. DK")
%>% filter(care.win !="0. NA; no Pre IW" ))
fct_to_int <- function(x){
return(as.integer(as_factor(x)))
}
anes_int <- apply(anes_cor,2,fct_to_int)
anes_int_wo_na <- na.omit(anes_int)
corrplot(cor(anes_int_wo_na),type="upper")
anes_white <- na.omit(anes_white %>% select(-care.win))
anes_vote_education = anes_white %>%
group_by(year,education)%>%
count(interest)%>%
group_by(year,education)%>%
mutate(
prop=n/sum(n)
)
ggplot(anes_vote_education,
aes(x=year, y=prop,group=interest)) +
geom_line(aes(colour=interest)) + facet_wrap(~education, ncol=1) +theme_bw()+
labs(title="How did different racial groups participated in the election \n over the years?")
anes_vote_education = anes_white %>%
group_by(self.consider,education)%>%
count(vote)%>%
group_by(self.consider,education)%>%
mutate(
prop=n/sum(n)
)
ggplot(anes_vote_education,
aes(x=self.consider, y=n, fill=vote)) +
geom_bar(stat="identity", colour="white") + facet_wrap(~education, ncol=1) +theme_bw()+
scale_fill_brewer(palette="BuPu")+
labs(y="",
title="Voting Proportion v.s. Self-Consideration for Education Groups ")
anes_vote_education = anes_white %>%
group_by(self.consider,education)%>%
count(vote)%>%
group_by(self.consider,education)%>%
mutate(
prop=n/sum(n)
)
ggplot(anes_vote_education,
aes(x=self.consider, y=n, fill=vote)) +
geom_bar(stat="identity", colour="white") + facet_wrap(~education, ncol=1) +theme_bw()+
scale_fill_brewer(palette="BuPu")+ theme(axis.text.x = element_text(angle = 45))+
labs(y="",
title="Voting Proportion v.s. Self-Consideration for Education Groups ")
anes_vote_education = anes_white %>%
group_by(self.consider,education)%>%
count(vote)%>%
group_by(self.consider,education)%>%
mutate(
prop=n/sum(n)
)
ggplot(anes_vote_education,
aes(x=self.consider, y=n, fill=vote)) +
geom_bar(stat="identity", colour="white") + facet_wrap(~education, ncol=1) +theme_bw()+
scale_fill_brewer(palette="BuPu")+ theme(axis.text.x = element_text(angle = 90))+
labs(y="",
title="Voting Proportion v.s. Self-Consideration for Education Groups ")
anes_vote_education = anes_white %>%
group_by(self.consider,education)%>%
count(vote)%>%
group_by(self.consider,education)%>%
mutate(
prop=n/sum(n)
)
ggplot(anes_vote_education,
aes(x=self.consider, y=n, fill=vote)) +
geom_bar(stat="identity", colour="white") + facet_wrap(~education, ncol=1) +theme_bw()+
scale_fill_brewer(palette="BuPu")+ theme(axis.text.x = element_text(angle = 70))+
labs(y="",
title="Voting Proportion v.s. Self-Consideration for Education Groups ")
anes_vote_education = anes_white %>%
group_by(self.consider,education)%>%
count(vote)%>%
group_by(self.consider,education)%>%
mutate(
prop=n/sum(n)
)
ggplot(anes_vote_education,
aes(x=self.consider, y=n, fill=vote)) +
geom_bar(stat="identity", colour="white") + facet_wrap(~education, ncol=1) +theme_bw()+
scale_fill_brewer(palette="BuPu")+ theme(axis.text.x = element_text(angle = 90))+
labs(y="",
title="Voting Proportion v.s. Self-Consideration for Education Groups ")
anes_vote_education = anes_white %>%
group_by(self.consider,education)%>%
count(vote)%>%
group_by(self.consider,education)%>%
mutate(
prop=n/sum(n)
)
ggplot(anes_vote_education,
aes(x=self.consider, y=n, fill=vote)) +
geom_bar(stat="identity", colour="white") + facet_wrap(~education, ncol=1) +theme_bw()+
scale_fill_brewer(palette="BuPu")+ theme(axis.text.x = element_text(angle = 90))+
labs(y="",x="Self-Consideration",
title="Voting Proportion v.s. Self-Consideration for Education Groups ")
anes_vote_education = anes_white %>%
group_by(self.consider,education)%>%
count(vote)%>%
group_by(self.consider,education)%>%
mutate(
prop=n/sum(n)
)
ggplot(anes_vote_education,
aes(x=self.consider, y=n, fill=vote)) +
geom_bar(stat="identity", colour="white") + facet_wrap(~education, ncol=1) +theme_bw()+
scale_fill_brewer(palette="Greens")+ theme(axis.text.x = element_text(angle = 90))+
labs(y="",x="Self-Consideration",
title="Voting Proportion v.s. Self-Consideration for Education Groups ")
anes_vote_education = anes_white %>%
group_by(self.consider,education)%>%
count(vote)%>%
group_by(self.consider,education)%>%
mutate(
prop=n/sum(n)
)
ggplot(anes_vote_education,
aes(x=self.consider, y=n, fill=vote)) +
geom_bar(stat="identity", colour="white") + facet_wrap(~education, ncol=1) +theme_bw()+
scale_fill_brewer(palette="RdPu")+ theme(axis.text.x = element_text(angle = 90))+
labs(y="",x="Self-Consideration",
title="Voting Proportion v.s. Self-Consideration for Education Groups ")
anes_vote_education = anes_white %>%
group_by(self.consider,education)%>%
count(vote)%>%
group_by(self.consider,education)%>%
mutate(
prop=n/sum(n)
)
ggplot(anes_vote_education,
aes(x=self.consider, y=n, fill=vote)) +
geom_bar(stat="identity", colour="white") + facet_wrap(~education, ncol=1) +theme_bw()+
scale_fill_brewer(palette="BuPu")+
labs(title="How did different racial groups participated in the election \n over the years?")
ggplot(anes_vote_education,
aes(x=self.consider, y=n, fill=vote)) +
geom_bar(stat="identity", colour="white") + facet_wrap(~education, ncol=1) +theme(axis.title.x = "")+theme_bw()+
scale_fill_brewer(palette="BuPu")+
labs(title="How did different racial groups participated in the election \n over the years?")
ggplot(anes_vote_education,
aes(x=self.consider, y=n, fill=vote)) +
geom_bar(stat="identity", colour="white") + facet_wrap(~education, ncol=1) +theme(axis.title.x = "")+theme_bw()+
scale_fill_brewer(palette="BuPu")+
labs(title="How did different racial groups participated in the election \n over the years?")
anes_vote_education = anes_white %>%
group_by(income,education)%>%
count(vote)%>%
group_by(income,education)%>%
mutate(
prop=n/sum(n)
)
ggplot(anes_vote_education,
aes(x=income, y=prop, fill=vote)) +
geom_bar(stat="identity", colour="white") + facet_wrap(~education, ncol=1) +
theme(axis.text.x = element_text(angle = 90)) +theme_bw()+
scale_fill_brewer(palette="RdPu")+
labs(title="Votes v.s Income for Education Groups")
anes_vote_education = anes_white %>%
group_by(income,education)%>%
count(vote)%>%
group_by(income,education)%>%
mutate(
prop=n/sum(n)
)
ggplot(anes_vote_education,
aes(x=income, y=prop, fill=vote)) +
geom_bar(stat="identity", colour="white") + facet_wrap(~education, ncol=1) +
theme(axis.text.x = element_text(angle = 90)) +theme_bw()+
scale_fill_brewer(palette="RdPu")+
labs(title="Votes v.s Income for Education Groups")
anes_vote_education = anes_white %>%
group_by(income,education)%>%
count(vote)%>%
group_by(income,education)%>%
mutate(
prop=n/sum(n)
)
ggplot(anes_vote_education,
aes(x=income, y=prop, fill=vote)) +
geom_bar(stat="identity", colour="white") + facet_wrap(~education, ncol=1) +
theme(axis.text.x = element_text(angle = 45)) +theme_bw()+
scale_fill_brewer(palette="RdPu")+
labs(title="Votes v.s Income for Education Groups")
anes_vote_education = anes_white %>%
group_by(income,education)%>%
count(vote)%>%
group_by(income,education)%>%
mutate(
prop=n/sum(n)
)
ggplot(anes_vote_education,
aes(x=income, y=prop, fill=vote)) +
geom_bar(stat="identity", colour="white") + facet_wrap(~education, ncol=1) +
theme_bw()+
scale_fill_brewer(palette="RdPu")+theme(axis.text.x = element_text(angle = 90))+
labs(title="Votes v.s Income for Education Groups")
anes_vote_education = anes_white %>%
group_by(income,education)%>%
count(vote)%>%
group_by(income,education)%>%
mutate(
prop=n/sum(n)
)
ggplot(anes_vote_education,
aes(x=income, y=prop, fill=vote)) +
geom_bar(stat="identity", colour="white") + facet_wrap(~education, ncol=1) +
theme_bw()+
scale_fill_brewer(palette="RdPu")+theme(axis.text.x = element_text(angle = 90))+
labs(x="Income(Low -> High)",title="Votes v.s Income for Education Groups")
anes_vote_education = anes_white %>%
group_by(income,education)%>%
count(vote)%>%
group_by(income,education)%>%
mutate(
prop=n/sum(n)
)
ggplot(anes_vote_education,
aes(x=income, y=prop, fill=vote)) +
geom_bar(stat="identity", colour="white") + facet_wrap(~education, ncol=1) +
theme_bw()+
scale_fill_brewer(palette="RdPu")+
labs(x="Income(Low -> High)",title="Votes v.s Income for Education Groups")
anes_vote_education = anes_white %>%
group_by(income,education)%>%
count(vote)%>%
group_by(income,education)%>%
mutate(
prop=n/sum(n)
)
ggplot(anes_vote_education,
aes(x=income, y=prop, fill=vote)) +
geom_bar(stat="identity", colour="white") + facet_wrap(~education, ncol=1) +theme(axis.title.x=element_blank())
theme_bw()+
scale_fill_brewer(palette="RdPu")+
labs(x="Income(Low -> High)",title="Votes v.s Income for Education Groups")
anes_vote_education = anes_white %>%
group_by(income,education)%>%
count(vote)%>%
group_by(income,education)%>%
mutate(
prop=n/sum(n)
)
ggplot(anes_vote_education,
aes(x=income, y=prop, fill=vote)) +
geom_bar(stat="identity", colour="white") + facet_wrap(~education, ncol=1)
theme_bw()+
scale_fill_brewer(palette="RdPu")+
labs(x="Income(Low -> High)",title="Votes v.s Income for Education Groups")
anes_vote_education = anes_white %>%
group_by(income,education)%>%
count(vote)%>%
group_by(income,education)%>%
mutate(
prop=n/sum(n)
)
ggplot(anes_vote_education,
aes(x=income, y=prop, fill=vote)) +
geom_bar(stat="identity", colour="white") + facet_wrap(~education, ncol=1) +
theme_bw()+
scale_fill_brewer(palette="RdPu")+
labs(x="Income(Low -> High)",title="Votes v.s Income for Education Groups")
anes_vote_education = anes_white %>%
group_by(income,education)%>%
count(vote)%>%
group_by(income,education)%>%
mutate(
prop=n/sum(n)
)
ggplot(anes_vote_education,
aes(x=income, y=prop, fill=vote)) +
geom_bar(stat="identity", colour="white") + facet_wrap(~education, ncol=1) +theme(axis.title.x=element_blank())
theme_bw()+
scale_fill_brewer(palette="RdPu")+
labs(x="Income(Low -> High)",title="Votes v.s Income for Education Groups")
anes_vote_education = anes_white %>%
group_by(income,education)%>%
count(vote)%>%
group_by(income,education)%>%
mutate(
prop=n/sum(n)
)
ggplot(anes_vote_education,
aes(x=income, y=prop, fill=vote)) +
geom_bar(stat="identity", colour="white") + facet_wrap(~education, ncol=1) +
theme_bw()+theme(axis.title.x=element_blank())+
scale_fill_brewer(palette="RdPu")+
labs(x="Income(Low -> High)",title="Votes v.s Income for Education Groups")
anes_vote_education = anes_white %>%
group_by(income,education)%>%
count(vote)%>%
group_by(income,education)%>%
mutate(
prop=n/sum(n)
)
ggplot(anes_vote_education,
aes(x=income, y=prop, fill=vote)) +
geom_bar(stat="identity", colour="white") + facet_wrap(~education, ncol=1) +
theme_bw()+theme(axis.text.x=element_blank())+
scale_fill_brewer(palette="RdPu")+
labs(x="Income(Low -> High)",title="Votes v.s Income for Education Groups")
anes_vote_education = anes_white %>%
group_by(self.consider,education)%>%
count(vote)%>%
group_by(self.consider,education)%>%
mutate(
prop=n/sum(n)
)
ggplot(anes_vote_education,
aes(x=self.consider, y=n, fill=vote)) +
geom_bar(stat="identity", colour="white") + facet_wrap(~education, ncol=1) +theme_bw()+
scale_fill_brewer(palette="RdPu")+ theme(axis.text.x = element_text(angle = 90))+theme(axis.text.x=element_blank())+
labs(y="",x="Self-Consideration(Democrat -> Independent -> Republican)",
title="Voting Proportion v.s. Self-Consideration for Education Groups ")
